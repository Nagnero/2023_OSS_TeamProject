<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      @import url("https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800;900&display=swap");
      body,
      html {
        height: 100%;
        margin: 0;
        font-family: "Poppins", sans-serif;
      }

      .topnav {
        overflow: hidden;
        background-color: #333;
      }

      .topnav a {
        float: left;
        color: #f2f2f2;
        text-align: center;
        padding: 14px 16px;
        text-decoration: none;
        font-size: 17px;
      }

      .topnav a:hover {
        background-color: #ddd;
        color: black;
      }

      .topnav a.active {
        background-color: #04aa6d;
        color: white;
      }

      /* Layout styles */
      .container {
        display: grid;
        grid-template-columns: 3fr 1fr; /* Adjust the ratio to 3:1 */
        gap: 10px;
        padding: 10px;
        height: calc(
          100% - 48px
        ); /* Adjust height to account for topnav height */
      }

      .sidebar {
        grid-column: 2 / 3; /* Move sidebar to the right side */
        background-color: #f1f1f1;
        padding: 20px;
      }

      .main-content {
        grid-column: 1 / 2; /* Expand main content to the left side */
        background-color: #fff; /* Set background color to white */
        padding: 20px;
        border: 1px solid black;
      }

      .header {
        background-color: greenyellow;
        padding: 10px;
        text-align: center;
        font-size: 20px;
        font-family: "Poppins", sans-serif;
      }

      .content {
        /* Main content styles */
        height: 100%; /* Set content to fill the height */
      }
    </style>
  </head>
  <body>
    <div class="topnav">
      <a class="active" href="Domestic.html">Domestic</a>
      <a href="Index.html">Index</a>
      <a href="Resource.html">Resource</a>
    </div>

    <div class="container">
      <div class="main-content">
        <div class="header">
          <p>Domestic</p>
        </div>

        <div class="content">
          <!-- Main content here -->
          <h2>Top Navigation Example</h2>
          <p>Page : Domestic</p>
          <!-- Rest of the content -->
        </div>
      </div>

      <div class="sidebar">
        <!-- Sidebar content here -->
        <p>Sidebar content...</p>
      </div>
    </div>
    <script>
      // URL 변수 설정
      const url = "http://localhost:5000/domestic";

      // 서버로부터 JSON 데이터 가져오기
      fetch(url)
        .then((response) => {
          // HTTP 상태코드 확인
          if (!response.ok) {
            throw new Error("Network response was not ok.");
          }
          return response.json(); // JSON 데이터로 변환
        })
        .then((data) => {
          // 가져온 JSON 데이터 처리
          console.log("반환된 데이터:", data);

          // HTML 생성 및 동적으로 데이터 할당
          const table = document.createElement("table");
          const thead = document.createElement("thead");
          const tbody = document.createElement("tbody");

          // 테이블 헤더 생성
          const headers = ["회사명", "등락률", "시가총액", "주가", "뉴스"];
          const headerRow = document.createElement("tr");

          headers.forEach((headerText) => {
            const th = document.createElement("th");
            th.appendChild(document.createTextNode(headerText));
            headerRow.appendChild(th);
          });

          thead.appendChild(headerRow);
          table.appendChild(thead);

          // 테이블 바디 생성
          for (let i = 0; i < data.result_name.length; i++) {
            const row = document.createElement("tr");

            // 회사명, 등락률, 시가총액, 주가
            const nameCell = document.createElement("td");
            const rateCell = document.createElement("td");
            const mCapCell = document.createElement("td");
            const priceCell = document.createElement("td");

            nameCell.textContent = data.result_name[i];
            rateCell.textContent = data.result_rate[i];
            mCapCell.textContent = data.result_m_cap[i];
            priceCell.textContent = data.result_price[i];

            row.appendChild(nameCell);
            row.appendChild(rateCell);
            row.appendChild(mCapCell);
            row.appendChild(priceCell);

            // 뉴스 정보 (링크)
            const newsCell = document.createElement("td");
            if (data.result_news_info[i] && data.result_news_info[i].title) {
              const newsLink = document.createElement("a");
              newsLink.href = data.result_news_info[i].link;
              newsLink.textContent = "뉴스 보기";
              newsCell.appendChild(newsLink);
            } else {
              newsCell.textContent = "뉴스 없음";
            }
            row.appendChild(newsCell);

            tbody.appendChild(row);
          }

          table.appendChild(tbody);

          // 생성된 테이블을 body에 추가
          //document.body.appendChild(table);
          const contentDiv = document.querySelector(".content"); // '.content' 요소 찾기
          contentDiv.appendChild(table); // 테이블을 '.content' 안에 추가

          // 여기서는 간단히 가져온 데이터를 콘솔에 출력하는 예제를 보여드립니다.
        })
        .catch((error) => {
          // 오류 처리
          console.error("Fetch Error:", error);
        });
    </script>
  </body>
</html>
